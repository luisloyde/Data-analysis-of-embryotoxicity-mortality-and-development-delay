} else {
print('non-normal distribution')
}
result.wilcox<-wilcox.test(gmi_agua_sed_P1$'12 h'~gmi_agua_sed_P1$Punto, data=gmi_agua_sed_P1)
if (result.wilcox$p.value > 0.05){
print('no significant differences')
} else {
print('significant differences')
}
result.wilcox$p.value
result.shapiro<-shapiro.test(gmi_agua_sed_P1$`24 h`)
if (result.shapiro$p.value > 0.05){
print('normal distribution')
} else {
print('non-normal distribution')
}
result.wilcox<-wilcox.test(gmi_agua_sed_P1$'24 h'~gmi_agua_sed_P1$Punto, data=gmi_agua_sed_P1)
if (result.wilcox$p.value > 0.05){
print('no significant differences')
} else {
print('significant differences')
}
result.wilcox$p.value
result.shapiro<-shapiro.test(gmi_agua_sed_P1$`48 h`)
if (result.shapiro$p.value > 0.05){
print('normal distribution')
} else {
print('non-normal distribution')
}
result.wilcox<-wilcox.test(gmi_agua_sed_P1$'48 h'~gmi_agua_sed_P1$Punto, data=gmi_agua_sed_P1)
if (result.wilcox$p.value > 0.05){
print('no significant differences')
} else {
print('significant differences')
}
result.wilcox$p.value
result.shapiro<-shapiro.test(gmi_agua_sed_P1$`72 h`)
if (result.shapiro$p.value > 0.05){
print('normal distribution')
} else {
print('non-normal distribution')
}
result.wilcox<-wilcox.test(gmi_agua_sed_P1$'72 h'~gmi_agua_sed_P1$Punto, data=gmi_agua_sed_P1)
if (result.wilcox$p.value > 0.05){
print('no significant differences')
} else {
print('significant differences')
}
result.wilcox$p.value
result.shapiro<-shapiro.test(gmi_agua_sed_P1$`96 h`)
if (result.shapiro$p.value > 0.05){
print('normal distribution')
} else {
print('non-normal distribution')
}
result.wilcox<-wilcox.test(gmi_agua_sed_P1$'96 h'~gmi_agua_sed_P1$Punto, data=gmi_agua_sed_P1)
if (result.wilcox$p.value > 0.05){
print('no significant differences')
} else {
print('significant differences')
}
result.wilcox$p.value
result.shapiro<-shapiro.test(gmi_agua_sed_P2$`12 h`)
if (result.shapiro$p.value > 0.05){
print('normal distribution')
} else {
print('non-normal distribution')
}
result.wilcox<-wilcox.test(gmi_agua_sed_P2$'12 h'~gmi_agua_sed_P2$Punto, data=gmi_agua_sed_P2)
if (result.wilcox$p.value > 0.05){
print('no significant differences')
} else {
print('significant differences')
}
result.wilcox$p.value
result.shapiro<-shapiro.test(gmi_agua_sed_P2$`24 h`)
if (result.shapiro$p.value > 0.05){
print('normal distribution')
} else {
print('non-normal distribution')
}
result.wilcox<-wilcox.test(gmi_agua_sed_P2$'24 h'~gmi_agua_sed_P2$Punto, data=gmi_agua_sed_P2)
if (result.wilcox$p.value > 0.05){
print('no significant differences')
} else {
print('significant differences')
}
result.wilcox$p.value
result.shapiro<-shapiro.test(gmi_agua_sed_P2$`48 h`)
if (result.shapiro$p.value > 0.05){
print('normal distribution')
} else {
print('non-normal distribution')
}
result.wilcox<-wilcox.test(gmi_agua_sed_P2$'48 h'~gmi_agua_sed_P2$Punto, data=gmi_agua_sed_P2)
if (result.wilcox$p.value > 0.05){
print('no significant differences')
} else {
print('significant differences')
}
result.wilcox$p.value
result.shapiro<-shapiro.test(gmi_agua_sed_P2$`72 h`)
if (result.shapiro$p.value > 0.05){
print('normal distribution')
} else {
print('non-normal distribution')
}
result.wilcox<-wilcox.test(gmi_agua_sed_P2$'72 h'~gmi_agua_sed_P2$Punto, data=gmi_agua_sed_P2)
if (result.wilcox$p.value > 0.05){
print('no significant differences')
} else {
print('significant differences')
}
result.wilcox$p.value
result.shapiro<-shapiro.test(gmi_agua_sed_P2$`96 h`)
if (result.shapiro$p.value > 0.05){
print('normal distribution')
} else {
print('non-normal distribution')
}
result.wilcox<-wilcox.test(gmi_agua_sed_P2$'96 h'~gmi_agua_sed_P2$Punto, data=gmi_agua_sed_P2)
if (result.wilcox$p.value > 0.05){
print('no significant differences')
} else {
print('significant differences')
}
result.wilcox$p.value
result.shapiro<-shapiro.test(gmi_agua_sed_P3$`12 h`)
if (result.shapiro$p.value > 0.05){
print('normal distribution')
} else {
print('non-normal distribution')
}
result.wilcox<-wilcox.test(gmi_agua_sed_P3$'12 h'~gmi_agua_sed_P3$Punto, data=gmi_agua_sed_P3)
if (result.wilcox$p.value > 0.05){
print('no significant differences')
} else {
print('significant differences')
}
result.wilcox$p.value
result.shapiro<-shapiro.test(gmi_agua_sed_P3$`24 h`)
if (result.shapiro$p.value > 0.05){
print('normal distribution')
} else {
print('non-normal distribution')
}
result.wilcox<-wilcox.test(gmi_agua_sed_P3$'24 h'~gmi_agua_sed_P3$Punto, data=gmi_agua_sed_P3)
if (result.wilcox$p.value > 0.05){
print('no significant differences')
} else {
print('significant differences')
}
result.wilcox$p.value
result.shapiro<-shapiro.test(gmi_agua_sed_P3$`48 h`)
if (result.shapiro$p.value > 0.05){
print('normal distribution')
} else {
print('non-normal distribution')
}
result.wilcox<-wilcox.test(gmi_agua_sed_P3$'48 h'~gmi_agua_sed_P3$Punto, data=gmi_agua_sed_P3)
if (result.wilcox$p.value > 0.05){
print('no significant differences')
} else {
print('significant differences')
}
result.wilcox$p.value
result.shapiro<-shapiro.test(gmi_agua_sed_P3$`72 h`)
if (result.shapiro$p.value > 0.05){
print('normal distribution')
} else {
print('non-normal distribution')
}
result.wilcox<-wilcox.test(gmi_agua_sed_P3$'72 h'~gmi_agua_sed_P3$Punto, data=gmi_agua_sed_P3)
if (result.wilcox$p.value > 0.05){
print('no significant differences')
} else {
print('significant differences')
}
result.wilcox$p.value
result.shapiro<-shapiro.test(gmi_agua_sed_P3$`96 h`)
if (result.shapiro$p.value > 0.05){
print('normal distribution')
} else {
print('non-normal distribution')
}
result.wilcox<-wilcox.test(gmi_agua_sed_P3$'96 h'~gmi_agua_sed_P3$Punto, data=gmi_agua_sed_P3)
if (result.wilcox$p.value > 0.05){
print('no significant differences')
} else {
print('significant differences')
}
result.wilcox$p.value
result.shapiro<-shapiro.test(gmi_agua_sed_P4$`12 h`)
if (result.shapiro$p.value > 0.05){
print('normal distribution')
} else {
print('non-normal distribution')
}
result.wilcox<-wilcox.test(gmi_agua_sed_P4$'12 h'~gmi_agua_sed_P3$Punto, data=gmi_agua_sed_P3)
if (result.wilcox$p.value > 0.05){
print('no significant differences')
} else {
print('significant differences')
}
result.wilcox$p.value
result.shapiro<-shapiro.test(gmi_agua_sed_P4$`24 h`)
if (result.shapiro$p.value > 0.05){
print('normal distribution')
} else {
print('non-normal distribution')
}
result.wilcox<-wilcox.test(gmi_agua_sed_P4$'24 h'~gmi_agua_sed_P3$Punto, data=gmi_agua_sed_P3)
if (result.wilcox$p.value > 0.05){
print('no significant differences')
} else {
print('significant differences')
}
result.wilcox$p.value
result.shapiro<-shapiro.test(gmi_agua_sed_P4$`48 h`)
if (result.shapiro$p.value > 0.05){
print('normal distribution')
} else {
print('non-normal distribution')
}
result.wilcox<-wilcox.test(gmi_agua_sed_P4$'48 h'~gmi_agua_sed_P3$Punto, data=gmi_agua_sed_P3)
if (result.wilcox$p.value > 0.05){
print('no significant differences')
} else {
print('significant differences')
}
result.wilcox$p.value
result.shapiro<-shapiro.test(gmi_agua_sed_P4$`72 h`)
if (result.shapiro$p.value > 0.05){
print('normal distribution')
} else {
print('non-normal distribution')
}
result.wilcox<-wilcox.test(gmi_agua_sed_P4$'72 h'~gmi_agua_sed_P3$Punto, data=gmi_agua_sed_P3)
if (result.wilcox$p.value > 0.05){
print('no significant differences')
} else {
print('significant differences')
}
result.wilcox$p.value
result.shapiro<-shapiro.test(gmi_agua_sed_P4$`96 h`)
if (result.shapiro$p.value > 0.05){
print('normal distribution')
} else {
print('non-normal distribution')
}
result.wilcox<-wilcox.test(gmi_agua_sed_P4$'96 h'~gmi_agua_sed_P3$Punto, data=gmi_agua_sed_P3)
if (result.wilcox$p.value > 0.05){
print('no significant differences')
} else {
print('significant differences')
}
result.wilcox$p.value
result.shapiro<-shapiro.test(gmi_agua_sed_T$`12 h`)
if (result.shapiro$p.value > 0.05){
print('normal distribution')
} else {
print('non-normal distribution')
}
result.wilcox<-wilcox.test(gmi_agua_sed_T$'12 h'~gmi_agua_sed_T$Punto, data=gmi_agua_sed_T)
if (result.wilcox$p.value > 0.05){
print('no significant differences')
} else {
print('significant differences')
}
result.wilcox$p.value
result.shapiro<-shapiro.test(gmi_agua_sed_T$`24 h`)
if (result.shapiro$p.value > 0.05){
print('normal distribution')
} else {
print('non-normal distribution')
}
result.wilcox<-wilcox.test(gmi_agua_sed_T$'24 h'~gmi_agua_sed_T$Punto, data=gmi_agua_sed_T)
if (result.wilcox$p.value > 0.05){
print('no significant differences')
} else {
print('significant differences')
}
result.wilcox$p.value
result.shapiro<-shapiro.test(gmi_agua_sed_T$`48 h`)
if (result.shapiro$p.value > 0.05){
print('normal distribution')
} else {
print('non-normal distribution')
}
result.wilcox<-wilcox.test(gmi_agua_sed_T$'48 h'~gmi_agua_sed_T$Punto, data=gmi_agua_sed_T)
if (result.wilcox$p.value > 0.05){
print('no significant differences')
} else {
print('significant differences')
}
result.wilcox$p.value
result.shapiro<-shapiro.test(gmi_agua_sed_T$`72 h`)
if (result.shapiro$p.value > 0.05){
print('normal distribution')
} else {
print('non-normal distribution')
}
result.wilcox<-wilcox.test(gmi_agua_sed_T$'72 h'~gmi_agua_sed_T$Punto, data=gmi_agua_sed_T)
if (result.wilcox$p.value > 0.05){
print('no significant differences')
} else {
print('significant differences')
}
result.wilcox$p.value
result.shapiro<-shapiro.test(gmi_agua_sed_T$`96 h`)
if (result.shapiro$p.value > 0.05){
print('normal distribution')
} else {
print('non-normal distribution')
}
result.wilcox<-wilcox.test(gmi_agua_sed_T$'96 h'~gmi_agua_sed_T$Punto, data=gmi_agua_sed_T)
if (result.wilcox$p.value > 0.05){
print('no significant differences')
} else {
print('significant differences')
}
result.wilcox$p.value
sed_pivot<-database[,1:5]
colnames(sed_pivot)<-c("conc","P4_s","P3_s","P2_s","P1_s")
sed_pivot<-pivot_longer(sed_pivot,!conc,names_to = "Punto",values_to = "Muertos")
agua_pivot<-database[,c(1,6:9)]
colnames(agua_pivot)<-c("conc","P4_a","P3_a","P2_a","P1_a")
agua_pivot<-pivot_longer(agua_pivot,!conc,names_to="Punto",values_to="Muertos")
sed_mean<-sed_pivot %>% group_by(Punto,conc) %>%
summarize(promedio=mean(Muertos, na.rm=TRUE),stderror=std.error(Muertos,na.rm=TRUE)) %>%
cbind(Matriz="Sedimento")
agua_mean<-agua_pivot %>% group_by(Punto,conc) %>%
summarize(promedio=mean(Muertos, na.rm=TRUE),stderror=std.error(Muertos, na.rm=TRUE)) %>%
cbind(Matriz="Agua poro")
sed_agua_mean<-rbind(sed_mean,agua_mean)
sed_pivot<-database[,1:5]
colnames(sed_pivot)<-c("conc","P4","P3","P2","P1")
sed_pivot<-pivot_longer(sed_pivot,!conc,names_to = "Punto",values_to = "Muertos") %>%
cbind(Matriz="Sedimento")
agua_pivot<-database[,c(1,6:9)]
colnames(agua_pivot)<-c("conc","P4","P3","P2","P1")
agua_pivot<-pivot_longer(agua_pivot,!conc,names_to="Punto",values_to="Muertos")%>%
cbind(Matriz="Agua poro")
sed_agua_pivot<-rbind(sed_pivot,agua_pivot)
sed_mean<-sed_pivot %>% group_by(Punto,conc) %>%
summarize(promedio=mean(Muertos, na.rm=TRUE),stderror=std.error(Muertos,na.rm=TRUE))%>%
cbind(Matriz="Sedimento")
agua_mean<-agua_pivot %>% group_by(Punto,conc) %>%
summarize(promedio=mean(Muertos, na.rm=TRUE),stderror=std.error(Muertos, na.rm=TRUE))%>%
cbind(Matriz="Agua poro")
sed_agua_mean<-rbind(sed_mean,agua_mean)
t1<-data.frame(Punto="C",
conc=100,
promedio=0.00000,
stderror=0.0000,
Matriz="Sedimento")
sed_mean<-rbind(sed_mean,t1)
t2<-data.frame(Punto="C",
conc=100,
promedio=5,
stderror=0.0000,
Matriz="Agua poro")
agua_mean<-rbind(agua_mean,t2)
mortalidad_sedimento<-read_excel("p values.xlsx", sheet = "mortalidad_sedimento")
mortalidad_agua<-read_excel("p values.xlsx", sheet = "mortalidad_aguaporo")
sed_mean$diff<-mortalidad_sedimento$diff
agua_mean$diff<-mortalidad_agua$diff
names<-c(C='C',
P1='P1 (NM)',
P2='P2 (RS)',
P3='P3 (RT)',
P4='P4 (VM)') #changing names
p1<-ggplot(sed_mean, aes(x=factor(conc), y=promedio, fill=Punto))+
geom_col(position=position_dodge())+
theme(axis.line = element_line(colour = "black"))+
geom_errorbar(aes(ymin=promedio-stderror, ymax=promedio+stderror),position=position_dodge(),alpha=0.5)+
xlab("Sediment (%)")+
ylab("Mean mortality (%)")+
ggtitle("Mean mortality at different sediment concentrations")+
facet_grid(~Punto,scales = "free_x", space = "free_x",switch = "x",labeller=as_labeller(names))+
scale_fill_discrete(name = "Punto", labels = c("Control", "P1 (NM)", "P2 (SR)","P3 (TR)","P4 (VM)"))+
#  scale_y_continuous(breaks = seq(0, 125, by = 25))+
#  ylim(0,120)+
scale_y_continuous(limits = c(0, 105), breaks = c(0,25,50,75,100))+
geom_text(aes(label=diff),size=4,hjust=0.5,vjust=-0.5,color="black")+
theme(plot.title = element_text(size = 10))+
theme(legend.title = element_text(size = 10))+
theme(legend.text = element_text(size = 10))+
theme(axis.title = element_text(size = 10))+
theme(axis.text = element_text(size = 10,angle = 45,hjust=1))+
theme(legend.position = "bottom")+
theme(legend.title=element_blank())
p1
#ggsave("mortalidad_sedimento_barras.png",width=1800,height=1200,units="px",dpi=200)
p2<-ggplot(agua_mean, aes(x=factor(conc), y=promedio, fill=Punto))+
geom_col(position=position_dodge())+
theme(axis.line = element_line(colour = "black"))+
geom_errorbar(aes(ymin=promedio-stderror, ymax=promedio+stderror),position=position_dodge(),alpha=0.5)+
xlab("Pore water (%)")+
ylab("Mean mortality  (%)")+
ggtitle("Mean mortality at different pore water concentrations")+
facet_grid(~Punto,scales = "free_x", space = "free_x",switch = "x",labeller=as_labeller(names))+
scale_fill_discrete(name = "Punto", labels = c("Control", "P1 (NM)", "P2 (SR)","P3 (TR)","P4 (VM)"))+
#  scale_y_continuous(breaks = seq(0, 125, by = 25))+
#  ylim(0,120)+
scale_y_continuous(limits = c(0, 105), breaks = c(0,25,50,75,100))+
geom_text(aes(label=diff),size=4,hjust=0.5,vjust=-0.5,color="black")+
theme(plot.title = element_text(size = 10))+
theme(legend.title = element_text(size = 10))+
theme(legend.text = element_text(size = 10))+
theme(axis.title = element_text(size = 10))+
theme(axis.text = element_text(size = 10,angle = 45,hjust=1))+
theme(legend.position = "bottom")+
theme(legend.title=element_blank())
p2
#ggsave("mortalidad_aguaporo_barras.png",width=1800,height=1200,units="px",dpi=200)
library(patchwork)
p1+p2
ggsave("Figure n. Mean mortality in sediment and pore water.tif",width=3500,height=1500,units="px",dpi=225,compression="lzw")
p<-ggplot(sed_mean[!is.na(sed_mean$promedio),], aes(x=factor(conc), y=promedio, colour=Punto,group=Punto))+
geom_point(size=2)+
geom_line()+
theme(axis.line = element_line(colour = "black"))+
geom_errorbar(aes(ymin=promedio-stderror, ymax=promedio+stderror),position=position_dodge(),alpha=0.5)+
xlab("Concentración de sedimento (%)")+
ylab("Mortalidad promedio (%)")+
ggtitle("Mortalidad promedio a diferentes concentraciones de sedimento")+
facet_grid(~Punto,scales = "free_x", space = "free_x",switch = "x",labeller=as_labeller(names))+
scale_fill_discrete(name = "Punto", labels = c("Control", "P1 (NM)", "P2 (RS)","P3 (RS)","P4 (VM)"))+
#  ylim(0,120)+
scale_y_continuous(breaks = seq(0, 125, by = 25))+
#  ylim(0,120)+
geom_text(aes(label=diff),size=4,hjust=0.5,vjust=-0.5,color="black")+
theme(plot.title = element_text(size = 10))+
theme(legend.title = element_text(size = 10))+
theme(legend.text = element_text(size = 10))+
theme(axis.title = element_text(size = 10))+
theme(axis.text = element_text(size = 7.5,angle = 45))
p
p<-ggplot(agua_mean[!is.na(agua_mean$promedio),], aes(x=factor(conc), y=promedio, colour=Punto,group=Punto))+
geom_point(size=2)+
geom_line()+
theme(axis.line = element_line(colour = "black"))+
geom_errorbar(aes(ymin=promedio-stderror, ymax=promedio+stderror),position=position_dodge(),alpha=0.5)+
xlab("Concentración de agua poro (%)")+
ylab("Mortalidad promedio (%)")+
ggtitle("Mortalidad promedio a diferentes concentraciones de agua poro")+
facet_grid(~Punto,scales = "free_x", space = "free_x",switch = "x",labeller=as_labeller(names))+
scale_fill_discrete(name = "Punto", labels = c("Control", "P1 (NM)", "P2 (RS)","P3 (RS)","P4 (VM)"))+
#  ylim(0,120)+
scale_y_continuous(breaks = seq(0, 125, by = 25))+
#  ylim(0,120)+
geom_text(aes(label=diff),size=4,hjust=0.5,vjust=-0.5,color="black")+
theme(plot.title = element_text(size = 10))+
theme(legend.title = element_text(size = 10))+
theme(legend.text = element_text(size = 10))+
theme(axis.title = element_text(size = 10))+
theme(axis.text = element_text(size = 7.5,angle = 45))
p
hatch_sed<-read_excel("Teratogénesis_R.xlsx",sheet='Eclosión sedimento')
hatch_agua<-read_excel("Teratogénesis_R.xlsx",sheet='Eclosión agua poro')
hatch_sed_long <- hatch_sed %>%
pivot_longer(cols = !Site,
names_to = 'Hour',
values_to = 'Hatching') %>%
group_by(Site, Hour) %>%
summarize(mean=mean(Hatching, na.rm = TRUE),
stderror=std.error(Hatching, na.rm = TRUE))
hatch_agua_long <- hatch_agua %>%
pivot_longer(cols = !Site,
names_to = 'Hour',
values_to = 'Hatching') %>%
group_by(Site, Hour) %>%
summarize(mean=mean(Hatching, na.rm = TRUE),
stderror=std.error(Hatching, na.rm = TRUE))
p1 <- ggplot(hatch_sed_long, aes(x = factor(Hour), y = mean, fill = Site))+
geom_col(position = position_dodge())+
theme(axis.line = element_line(colour = "black"))+
geom_errorbar(aes(ymin = mean-stderror, ymax = mean+stderror), position = position_dodge(), alpha = 0.5)+
xlab('Hour')+
ylab('Hatching rate (%)')+
ggtitle('Hatching rate over time in sediment')+
facet_grid(~Site, scales = 'free_x', space = 'free_x', switch = 'x')+
scale_fill_discrete(name = "Punto", labels = c("Control", "P1 (NM)", "P2 (SR)","P3 (TR)","P4 (VM)"))+
scale_y_continuous(limits = c(0, 105), breaks = c(0,25,50,75,100))+
theme(plot.title = element_text(size = 10))+
theme(legend.title = element_text(size = 10))+
theme(legend.text = element_text(size = 10))+
theme(axis.title = element_text(size = 10))+
theme(axis.text = element_text(size = 10,angle = 45,hjust=1))+
theme(legend.position = "bottom")+
theme(legend.title=element_blank())
p2 <- ggplot(hatch_agua_long, aes(x = factor(Hour), y = mean, fill = Site))+
geom_col(position = position_dodge())+
theme(axis.line = element_line(colour = "black"))+
geom_errorbar(aes(ymin = mean-stderror, ymax = mean+stderror), position = position_dodge(), alpha = 0.5)+
xlab('Hour')+
ylab('Hatching rate (%)')+
ggtitle('Hatching rate over time in pore water')+
facet_grid(~Site, scales = 'free_x', space = 'free_x', switch = 'x')+
scale_fill_discrete(name = "Punto", labels = c("Control", "P1 (NM)", "P2 (SR)","P3 (TR)","P4 (VM)"))+
scale_y_continuous(limits = c(0, 105), breaks = c(0,25,50,75,100))+
theme(plot.title = element_text(size = 10))+
theme(legend.title = element_text(size = 10))+
theme(legend.text = element_text(size = 10))+
theme(axis.title = element_text(size = 10))+
theme(axis.text = element_text(size = 10,angle = 45,hjust=1))+
theme(legend.position = "bottom")+
theme(legend.title=element_blank())
library(patchwork)
p1+p2
ggsave("Figure n. Hatching rate over time.tif",width=3500,height=1500,units="px",dpi=300,compression="lzw")
